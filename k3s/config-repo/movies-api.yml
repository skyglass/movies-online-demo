api:

  common:
    version: 1.0.0
    title: Sample API
    description: Description of the API...
    termsOfServiceUrl: MINE TERMS OF SERVICE URL
    license: License
    licenseUrl: MY LICENSE URL

    contact:
      name: Contact
      url: My
      email: me@mail.com

server.port: 7004
server.error.include-message: always
server.servlet.context-path: /movies-api

spring.application.name: movies-api
spring.data.mongodb:
  host: localhost
  port: 27017
  database: moviesdb

spring.cloud.stream:
  defaultBinder: rabbit
  default.contentType: application/json
  bindings:
    output-products:
      destination: products
      producer:
        required-groups: auditGroup
    output-recommendations:
      destination: recommendations
      producer:
        required-groups: auditGroup
    output-reviews:
      destination: reviews
      producer:
        required-groups: auditGroup

management:
  endpoints:
    web:
      exposure.include: beans, env, health, info, metrics, mappings
  endpoint:
    health:
      show-details: always        


spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: https://movie.skycomposer.net/auth/realms/demo
          jwk-set-uri: https://movie.skycomposer.net/auth/realms/demo/protocol/openid-connect/certs

      client:
        registration:
          keycloak:
            client-id: demoapp
            client-secret: demoapp
            clientName: Keycloak
            authorization-grant-type: authorization_code
            redirectUri: 'https://movie.skycomposer.net/movies-api/swagger-ui/index.html'
            redirectUriTemplate: '{baseUrl}/login/oauth2/code/{registrationId}'
            scope:
              - openid
              - profile
              - email

        provider:
          keycloak:
            authorization-uri: https://movie.skycomposer.net/auth/realms/demo/protocol/openid-connect/auth
            token-uri: https://movie.skycomposer.net/auth/realms/demo/protocol/openid-connect/token
            user-info-uri: https://movie.skycomposer.net/auth/realms/demo/protocol/openid-connect/userinfo
            jwk-set-uri: https://movie.skycomposer.net/auth/realms/demo/protocol/openid-connect/certs
            user-name-attribute: preferred_username

opentracing:
  jaeger:
    log-spans: true
    enable-b3-propagation: true
    enabled: true
    http-sender:
      url: http://jaeger-collector.istio-system:14268/api/traces

app.product-service.timeoutSec: 2

---
spring.config.activate.on-profile: docker

spring.data.mongodb.host: mongodb

server.port: 80

---
spring.config.activate.on-profile: streaming_partitioned

spring.cloud.stream.bindings.output-products.producer:
  partition-key-expression: payload.key
  partition-count: 2

spring.cloud.stream.bindings.output-recommendations.producer:
  partition-key-expression: payload.key
  partition-count: 2

spring.cloud.stream.bindings.output-reviews.producer:
  partition-key-expression: payload.key
  partition-count: 2

---
spring.config.activate.on-profile: prod

spring.data.mongodb.host: mongodb

logging:
  level:
    root: INFO
    skyglass.composer: DEBUG
    org.springframework.web: INFO
    org.springframework.security: INFO
    org.springframework.boot.autoconfigure: DEBUG    
    org.springframework.web.server.adapter.HttpWebHandlerAdapter: WARN